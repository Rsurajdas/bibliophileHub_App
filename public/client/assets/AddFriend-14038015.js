import{P as b,r as t,ak as N,c as g,j as s,L as y,a as v,B as u,k,Q as f,C as S}from"./index-a213bcde.js";import{T as F}from"./Title-a323805d.js";import{R as j,C as p}from"./Row-6003576e.js";const w=({profile:e})=>{const[o,c]=t.useState(!1),[m,l]=t.useState(!1),{user:i,isLoading:h}=N(),r=g("token");t.useEffect(()=>{const a=i.following.some(n=>n._id===e._id);c(a)},[e._id,i.following]),t.useEffect(()=>{const a=i.friends.some(n=>n._id===e._id);l(a)},[e._id,i.friends]);const d=async a=>{try{const x=await fetch(`https://boiling-wildwood-46640-30ec30629e36.herokuapp.com/api/v1/users/${o?"unfollow":"follow"}/${a}`,{method:"POST",headers:{Authorization:`Bearer ${r}`}});await x.json(),c(!o),f.success(x.message)}catch(n){f.error(n.message)}};return h?s.jsx(y,{}):s.jsxs("li",{children:[s.jsxs("div",{className:"friend-item",children:[s.jsxs("div",{className:"friend-left",children:[s.jsx("div",{className:"friend-img",children:s.jsx("img",{src:e.photo,alt:e.name})}),s.jsxs("div",{className:"friend-detail ps-2",children:[s.jsx("h6",{className:"",style:{fontWeight:700,fontSize:"14px",margin:"0"},children:s.jsx(v,{to:`/profile/${e._id}`,children:e.name})}),s.jsx("div",{className:"",children:e.email})]})]}),s.jsxs("div",{className:"friend-right",children:[s.jsx(u,{text:m?"unfriend":"add friend",variant:"solid",sx:{display:"block",marginBottom:"10px"}}),s.jsx(u,{text:o?"following":"follow",variant:"solid",sx:{display:"block",backgroundColor:"#207e20",marginLeft:"auto"},onClick:()=>d(e._id)})]})]}),s.jsx(k,{position:"bottom-left"})]})};w.propTypes={profile:b.object};const B=()=>{const[e,o]=t.useState([]),[c,m]=t.useState(!0),l=t.useRef(null),i=g("token"),h=async r=>{r.preventDefault();try{const a=await(await fetch(`https://boiling-wildwood-46640-30ec30629e36.herokuapp.com/api/v1/users/search-member?query=${l.current.value}`,{method:"GET",headers:{Authorization:`Bearer ${i}`}})).json();m(!1),o(a.data.users)}catch(d){console.error(d.message)}};return s.jsx("main",{children:s.jsx("section",{className:"py-5",children:s.jsx(S,{children:s.jsx(j,{children:s.jsx(p,{md:10,className:"mx-auto",children:s.jsx(j,{className:"gx-5",children:s.jsx(p,{md:8,children:s.jsxs("div",{className:"friends-wrapper",children:[s.jsx(F,{element:s.jsx("h6",{className:"border-bottom pb-2 mb-2",style:{fontWeight:700,fontSize:"14px"},children:"Friends"})}),s.jsx("div",{className:"search-user",children:s.jsx("div",{className:"search-wrapper",children:s.jsx("form",{className:"search-form",onSubmit:h,children:s.jsxs("div",{className:"form-group",style:{marginBottom:"0"},children:[s.jsx("input",{type:"search",name:"search",id:"search",placeholder:"name or email",style:{fontSize:"12px"},ref:l}),s.jsx("button",{type:"submit",children:s.jsx("i",{className:"fa-solid fa-magnifying-glass"})})]})})})}),s.jsx("ul",{className:"mt-4",children:!c&&e.map(r=>s.jsx(w,{profile:r},r._id))})]})})})})})})})})};export{B as default};
