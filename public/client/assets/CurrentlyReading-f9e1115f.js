import{ac as Ye,ad as Qe,r as i,ae as Ve,v as H,j as t,_ as y,w as Z,af as Je,ag as Ze,W as et,a3 as ze,R as De,y as Ie,A as Me,D as W,F as S,G as Oe,x as Ae,ah as tt,ai as rt,X as je,Y as ke,P as J,c as He,g as ot,aj as nt,ak as st,a as X,a8 as oe,B as U,b as ie,k as at,Q as V}from"./index-3c314f58.js";import{T as it,r as lt,g as Ce,M as ct,P as dt,u as $e,i as ut}from"./Post-8a770ad9.js";/* empty css             */import{e as pt,k as de,c as ue,T as mt}from"./Typography-41db5ac4.js";import{d as ft}from"./debounce-517eeb3c.js";const ht=["className","component"];function gt(e={}){const{themeId:r,defaultTheme:o,defaultClassName:c="MuiBox-root",generateClassName:x}=e,P=Ye("div",{shouldForwardProp:v=>v!=="theme"&&v!=="sx"&&v!=="as"})(Qe);return i.forwardRef(function(s,g){const f=Ve(o),p=pt(s),{className:k,component:a="div"}=p,l=H(p,ht);return t.jsx(P,y({as:a,ref:g,className:Z(k,x?x(c):c),theme:r&&f[r]||f},l))})}const xt=Je(),vt=gt({themeId:Ze,defaultTheme:xt,defaultClassName:"MuiBox-root",generateClassName:et.generate}),ne=vt,bt=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function le(e){return`scale(${e}, ${e**2})`}const Pt={entering:{opacity:1,transform:le(1)},entered:{opacity:1,transform:"none"}},se=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),Ue=i.forwardRef(function(r,o){const{addEndListener:c,appear:x=!0,children:P,easing:m,in:v,onEnter:s,onEntered:g,onEntering:f,onExit:p,onExited:k,onExiting:a,style:l,timeout:n="auto",TransitionComponent:b=it}=r,h=H(r,bt),I=i.useRef(),z=i.useRef(),$=ze(),R=i.useRef(null),q=De(R,P.ref,o),_=d=>E=>{if(d){const N=R.current;E===void 0?d(N):d(N,E)}},Y=_(f),Q=_((d,E)=>{lt(d);const{duration:N,delay:D,easing:T}=Ce({style:l,timeout:n,easing:m},{mode:"enter"});let B;n==="auto"?(B=$.transitions.getAutoHeightDuration(d.clientHeight),z.current=B):B=N,d.style.transition=[$.transitions.create("opacity",{duration:B,delay:D}),$.transitions.create("transform",{duration:se?B:B*.666,delay:D,easing:T})].join(","),s&&s(d,E)}),ee=_(g),L=_(a),G=_(d=>{const{duration:E,delay:N,easing:D}=Ce({style:l,timeout:n,easing:m},{mode:"exit"});let T;n==="auto"?(T=$.transitions.getAutoHeightDuration(d.clientHeight),z.current=T):T=E,d.style.transition=[$.transitions.create("opacity",{duration:T,delay:N}),$.transitions.create("transform",{duration:se?T:T*.666,delay:se?N:N||T*.333,easing:D})].join(","),d.style.opacity=0,d.style.transform=le(.75),p&&p(d)}),te=_(k),K=d=>{n==="auto"&&(I.current=setTimeout(d,z.current||0)),c&&c(R.current,d)};return i.useEffect(()=>()=>{clearTimeout(I.current)},[]),t.jsx(b,y({appear:x,in:v,nodeRef:R,onEnter:Q,onEntered:ee,onEntering:Y,onExit:G,onExited:te,onExiting:L,addEndListener:K,timeout:n==="auto"?null:n},h,{children:(d,E)=>i.cloneElement(P,y({style:y({opacity:0,transform:le(.75),visibility:d==="exited"&&!v?"hidden":void 0},Pt[d],l,P.props.style),ref:q},E))}))});Ue.muiSupportAuto=!0;const yt=Ue;function jt(e){return Ie("MuiLinearProgress",e)}Me("MuiLinearProgress",["root","colorPrimary","colorSecondary","determinate","indeterminate","buffer","query","dashed","dashedColorPrimary","dashedColorSecondary","bar","barColorPrimary","barColorSecondary","bar1Indeterminate","bar1Determinate","bar1Buffer","bar2Indeterminate","bar2Buffer"]);const kt=["className","color","value","valueBuffer","variant"];let F=e=>e,Ee,Ne,Te,we,Re,_e;const ce=4,Ct=de(Ee||(Ee=F`
  0% {
    left: -35%;
    right: 100%;
  }

  60% {
    left: 100%;
    right: -90%;
  }

  100% {
    left: 100%;
    right: -90%;
  }
`)),$t=de(Ne||(Ne=F`
  0% {
    left: -200%;
    right: 100%;
  }

  60% {
    left: 107%;
    right: -8%;
  }

  100% {
    left: 107%;
    right: -8%;
  }
`)),Et=de(Te||(Te=F`
  0% {
    opacity: 1;
    background-position: 0 -23px;
  }

  60% {
    opacity: 0;
    background-position: 0 -23px;
  }

  100% {
    opacity: 1;
    background-position: -200px -23px;
  }
`)),Nt=e=>{const{classes:r,variant:o,color:c}=e,x={root:["root",`color${S(c)}`,o],dashed:["dashed",`dashedColor${S(c)}`],bar1:["bar",`barColor${S(c)}`,(o==="indeterminate"||o==="query")&&"bar1Indeterminate",o==="determinate"&&"bar1Determinate",o==="buffer"&&"bar1Buffer"],bar2:["bar",o!=="buffer"&&`barColor${S(c)}`,o==="buffer"&&`color${S(c)}`,(o==="indeterminate"||o==="query")&&"bar2Indeterminate",o==="buffer"&&"bar2Buffer"]};return Ae(x,jt,r)},pe=(e,r)=>r==="inherit"?"currentColor":e.vars?e.vars.palette.LinearProgress[`${r}Bg`]:e.palette.mode==="light"?tt(e.palette[r].main,.62):rt(e.palette[r].main,.5),Tt=W("span",{name:"MuiLinearProgress",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:o}=e;return[r.root,r[`color${S(o.color)}`],r[o.variant]]}})(({ownerState:e,theme:r})=>y({position:"relative",overflow:"hidden",display:"block",height:4,zIndex:0,"@media print":{colorAdjust:"exact"},backgroundColor:pe(r,e.color)},e.color==="inherit"&&e.variant!=="buffer"&&{backgroundColor:"none","&::before":{content:'""',position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:"currentColor",opacity:.3}},e.variant==="buffer"&&{backgroundColor:"transparent"},e.variant==="query"&&{transform:"rotate(180deg)"})),wt=W("span",{name:"MuiLinearProgress",slot:"Dashed",overridesResolver:(e,r)=>{const{ownerState:o}=e;return[r.dashed,r[`dashedColor${S(o.color)}`]]}})(({ownerState:e,theme:r})=>{const o=pe(r,e.color);return y({position:"absolute",marginTop:0,height:"100%",width:"100%"},e.color==="inherit"&&{opacity:.3},{backgroundImage:`radial-gradient(${o} 0%, ${o} 16%, transparent 42%)`,backgroundSize:"10px 10px",backgroundPosition:"0 -23px"})},ue(we||(we=F`
    animation: ${0} 3s infinite linear;
  `),Et)),Rt=W("span",{name:"MuiLinearProgress",slot:"Bar1",overridesResolver:(e,r)=>{const{ownerState:o}=e;return[r.bar,r[`barColor${S(o.color)}`],(o.variant==="indeterminate"||o.variant==="query")&&r.bar1Indeterminate,o.variant==="determinate"&&r.bar1Determinate,o.variant==="buffer"&&r.bar1Buffer]}})(({ownerState:e,theme:r})=>y({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",backgroundColor:e.color==="inherit"?"currentColor":(r.vars||r).palette[e.color].main},e.variant==="determinate"&&{transition:`transform .${ce}s linear`},e.variant==="buffer"&&{zIndex:1,transition:`transform .${ce}s linear`}),({ownerState:e})=>(e.variant==="indeterminate"||e.variant==="query")&&ue(Re||(Re=F`
      width: auto;
      animation: ${0} 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;
    `),Ct)),_t=W("span",{name:"MuiLinearProgress",slot:"Bar2",overridesResolver:(e,r)=>{const{ownerState:o}=e;return[r.bar,r[`barColor${S(o.color)}`],(o.variant==="indeterminate"||o.variant==="query")&&r.bar2Indeterminate,o.variant==="buffer"&&r.bar2Buffer]}})(({ownerState:e,theme:r})=>y({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left"},e.variant!=="buffer"&&{backgroundColor:e.color==="inherit"?"currentColor":(r.vars||r).palette[e.color].main},e.color==="inherit"&&{opacity:.3},e.variant==="buffer"&&{backgroundColor:pe(r,e.color),transition:`transform .${ce}s linear`}),({ownerState:e})=>(e.variant==="indeterminate"||e.variant==="query")&&ue(_e||(_e=F`
      width: auto;
      animation: ${0} 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite;
    `),$t)),Lt=i.forwardRef(function(r,o){const c=Oe({props:r,name:"MuiLinearProgress"}),{className:x,color:P="primary",value:m,valueBuffer:v,variant:s="indeterminate"}=c,g=H(c,kt),f=y({},c,{color:P,variant:s}),p=Nt(f),k=ze(),a={},l={bar1:{},bar2:{}};if((s==="determinate"||s==="buffer")&&m!==void 0){a["aria-valuenow"]=Math.round(m),a["aria-valuemin"]=0,a["aria-valuemax"]=100;let n=m-100;k.direction==="rtl"&&(n=-n),l.bar1.transform=`translateX(${n}%)`}if(s==="buffer"&&v!==void 0){let n=(v||0)-100;k.direction==="rtl"&&(n=-n),l.bar2.transform=`translateX(${n}%)`}return t.jsxs(Tt,y({className:Z(p.root,x),ownerState:f,role:"progressbar"},a,{ref:o},g,{children:[s==="buffer"?t.jsx(wt,{className:p.dashed,ownerState:f}):null,t.jsx(Rt,{className:p.bar1,ownerState:f,style:l.bar1}),s==="determinate"?null:t.jsx(_t,{className:p.bar2,ownerState:f,style:l.bar2})]}))}),Bt=Lt;function St(e){return Ie("MuiPopover",e)}Me("MuiPopover",["root","paper"]);const zt=["onEntering"],Dt=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","slots","slotProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps"],It=["slotProps"];function Le(e,r){let o=0;return typeof r=="number"?o=r:r==="center"?o=e.height/2:r==="bottom"&&(o=e.height),o}function Be(e,r){let o=0;return typeof r=="number"?o=r:r==="center"?o=e.width/2:r==="right"&&(o=e.width),o}function Se(e){return[e.horizontal,e.vertical].map(r=>typeof r=="number"?`${r}px`:r).join(" ")}function ae(e){return typeof e=="function"?e():e}const Mt=e=>{const{classes:r}=e;return Ae({root:["root"],paper:["paper"]},St,r)},Ot=W(ct,{name:"MuiPopover",slot:"Root",overridesResolver:(e,r)=>r.root})({}),At=W(dt,{name:"MuiPopover",slot:"Paper",overridesResolver:(e,r)=>r.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),Ht=i.forwardRef(function(r,o){var c,x,P;const m=Oe({props:r,name:"MuiPopover"}),{action:v,anchorEl:s,anchorOrigin:g={vertical:"top",horizontal:"left"},anchorPosition:f,anchorReference:p="anchorEl",children:k,className:a,container:l,elevation:n=8,marginThreshold:b=16,open:h,PaperProps:I={},slots:z,slotProps:$,transformOrigin:R={vertical:"top",horizontal:"left"},TransitionComponent:q=yt,transitionDuration:_="auto",TransitionProps:{onEntering:Y}={}}=m,Q=H(m.TransitionProps,zt),ee=H(m,Dt),L=(c=$==null?void 0:$.paper)!=null?c:I,G=i.useRef(),te=De(G,L.ref),K=y({},m,{anchorOrigin:g,anchorReference:p,elevation:n,marginThreshold:b,externalPaperSlotProps:L,transformOrigin:R,TransitionComponent:q,transitionDuration:_,TransitionProps:Q}),d=Mt(K),E=i.useCallback(()=>{if(p==="anchorPosition")return f;const u=ae(s),C=(u&&u.nodeType===1?u:je(G.current).body).getBoundingClientRect();return{top:C.top+Le(C,g.vertical),left:C.left+Be(C,g.horizontal)}},[s,g.horizontal,g.vertical,f,p]),N=i.useCallback(u=>({vertical:Le(u,R.vertical),horizontal:Be(u,R.horizontal)}),[R.horizontal,R.vertical]),D=i.useCallback(u=>{const j={width:u.offsetWidth,height:u.offsetHeight},C=N(j);if(p==="none")return{top:null,left:null,transformOrigin:Se(C)};const ge=E();let O=ge.top-C.vertical,A=ge.left-C.horizontal;const xe=O+j.height,ve=A+j.width,be=ke(ae(s)),Pe=be.innerHeight-b,ye=be.innerWidth-b;if(O<b){const w=O-b;O-=w,C.vertical+=w}else if(xe>Pe){const w=xe-Pe;O-=w,C.vertical+=w}if(A<b){const w=A-b;A-=w,C.horizontal+=w}else if(ve>ye){const w=ve-ye;A-=w,C.horizontal+=w}return{top:`${Math.round(O)}px`,left:`${Math.round(A)}px`,transformOrigin:Se(C)}},[s,p,E,N,b]),[T,B]=i.useState(h),M=i.useCallback(()=>{const u=G.current;if(!u)return;const j=D(u);j.top!==null&&(u.style.top=j.top),j.left!==null&&(u.style.left=j.left),u.style.transformOrigin=j.transformOrigin,B(!0)},[D]),We=(u,j)=>{Y&&Y(u,j),M()},Fe=()=>{B(!1)};i.useEffect(()=>{h&&M()}),i.useImperativeHandle(v,()=>h?{updatePosition:()=>{M()}}:null,[h,M]),i.useEffect(()=>{if(!h)return;const u=ft(()=>{M()}),j=ke(s);return j.addEventListener("resize",u),()=>{u.clear(),j.removeEventListener("resize",u)}},[s,h,M]);let me=_;_==="auto"&&!q.muiSupportAuto&&(me=void 0);const qe=l||(s?je(ae(s)).body:void 0),re=(x=z==null?void 0:z.root)!=null?x:Ot,fe=(P=z==null?void 0:z.paper)!=null?P:At,Ge=$e({elementType:fe,externalSlotProps:y({},L,{style:T?L.style:y({},L.style,{opacity:0})}),additionalProps:{elevation:n,ref:te},ownerState:K,className:Z(d.paper,L==null?void 0:L.className)}),he=$e({elementType:re,externalSlotProps:($==null?void 0:$.root)||{},externalForwardedProps:ee,additionalProps:{ref:o,slotProps:{backdrop:{invisible:!0}},container:qe,open:h},ownerState:K,className:Z(d.root,a)}),{slotProps:Ke}=he,Xe=H(he,It);return t.jsx(re,y({},Xe,!ut(re)&&{slotProps:Ke},{children:t.jsx(q,y({appear:!0,in:h,onEntering:We,onExited:Fe,timeout:me},Q,{children:t.jsx(fe,y({},Ge,{children:k}))}))}))}),Ut=Ht,Wt=({post:e})=>{const[r,o]=i.useState(!1),[c,x]=i.useState(!0),P=He("token"),[m,v]=i.useState(e.comments),s=ot(),g=i.useRef(null),f=async(a,l)=>{try{const h=await(await fetch(`https://boiling-wildwood-46640-30ec30629e36.herokuapp.com/api/v1/posts/${a}/${r?"unlike":"like"}`,{method:"POST",headers:{Authorization:`Bearer ${P}`}})).json();x(!1),console.log(h),o(h.post.likes.includes(l))}catch(n){console.error(n.message)}},p=(a,l)=>async n=>{n.preventDefault();const b={user:l,text:g.current.value},h=await ie.post(`https://boiling-wildwood-46640-30ec30629e36.herokuapp.com/api/v1/posts/${a}/add-comment`,b,{headers:{Authorization:`Bearer ${P}`}}),{data:I}=h;v(I.post.comments),g.current.value=""},{user:k}=nt(a=>a.user,st);return i.useEffect(()=>{const a=e.likes.some(l=>l._id===s);o(a)},[e.likes,s]),t.jsx(t.Fragment,{children:t.jsxs("div",{className:"post",children:[t.jsx("div",{className:"post-avatar",children:t.jsx(X,{to:`/profile/${e.user._id}`,children:t.jsx(oe,{alt:e.user.name,src:e.user.photo})})}),t.jsxs("div",{className:"post-header",children:[t.jsx("div",{className:"post-by mb-2",children:t.jsx("p",{style:{margin:0},children:e.text})}),t.jsxs("div",{className:"post-details",children:[t.jsx("div",{className:"post-img",children:t.jsx("img",{src:e.book.book_image,alt:e.book.title})}),t.jsxs("div",{className:"post-content",children:[t.jsx("h4",{children:t.jsx(X,{to:`/book/${e.book._id}`,children:e.book.title})}),t.jsxs("div",{className:"post-author",children:["by ",t.jsx(X,{to:"author",children:e.book.author.name})]}),t.jsx("div",{className:"post-description",children:t.jsx("p",{children:e.book.description})})]})]}),t.jsxs("div",{className:"post-activity",children:[t.jsx(U,{type:"button",variant:"text",text:`${r?"Unlike":"Like"}`,onClick:()=>f(e._id,s)})," ","|"," ",t.jsx(U,{type:"button",variant:"text",text:"Comment",onClick:()=>g.current.focus()})]})]}),t.jsxs("div",{className:"post-footer",children:[r&&t.jsx("div",{className:"post-liked",children:"You liked this"}),m&&t.jsx("ul",{className:"post-comments",children:m.map(a=>t.jsx("li",{children:t.jsxs("div",{className:"comment-body",children:[t.jsx(oe,{alt:a.user.name,src:`${a.user.photo}`}),t.jsxs("div",{className:"comment-user",children:[t.jsx("h6",{className:"user-name mb-1",children:t.jsx(X,{to:`/profile/${a.user._id}`,children:a.user.name})}),t.jsx("div",{className:"user-comment",children:a.text})]})]})},a._id))}),t.jsxs("div",{className:"post-comment",children:[t.jsx(oe,{alt:k.name,src:k.photo}),t.jsx("form",{method:"post",onSubmit:p(e._id,s),children:t.jsxs("div",{className:"form-group d-flex",style:{gap:"2%"},children:[t.jsx("textarea",{name:"comment",id:"comment",style:{height:"40px"},ref:g}),t.jsx(U,{variant:"solid",text:"comment",sx:{padding:"3px 10px"},type:"submit"})]})})]})]})]})})};Wt.propTypes={post:J.object};const Ft=({book:e,currentUser:r})=>{const[o,c]=i.useState(null),[x,P]=i.useState(e.readingProgress),m=i.useRef(null),v=He("token"),s=l=>{c(l.currentTarget)},g=()=>{c(null)},f=!!o,p=f?"simple-popover":void 0,k=async l=>{try{const n={readingProgress:Number(m.current.value)},b=await ie.patch(`https://boiling-wildwood-46640-30ec30629e36.herokuapp.com/api/v1/shelf/update-progress/${l}`,n,{headers:{Authorization:`Bearer ${v}`}}),{data:h}=b;P(m.current.value),V.success(h.message)}catch(n){V.error(n.message)}},a=async l=>{try{const n={readingProgress:100},b=await ie.patch(`https://boiling-wildwood-46640-30ec30629e36.herokuapp.com/api/v1/shelf/update-progress/${l}`,n,{headers:{Authorization:`Bearer ${v}`}}),{data:h}=b;P(100),c(null),V.success(h.message)}catch(n){V.error(n.message)}};return t.jsxs("div",{className:"reading mb-3",children:[t.jsx("div",{className:"reading-img",children:t.jsx("img",{src:e.book.book_image,alt:e.book.title})}),t.jsxs("div",{className:"reading-content",children:[t.jsx("h6",{children:t.jsx(X,{to:`/book/${e.book._id}`,style:{color:"#2a2a2a"},children:e.book.title})}),t.jsx("div",{className:"mb-2",children:e.book.author.name}),x>0&&t.jsxs(ne,{sx:{display:"flex",alignItems:"center"},children:[t.jsx(ne,{sx:{width:"100%",mr:1},children:t.jsx(Bt,{variant:"determinate",value:Number(x),color:"success"})}),t.jsx(ne,{sx:{minWidth:35},children:t.jsx(mt,{variant:"body2",color:"text.secondary",children:`${Math.round(x)}/100%`})})]}),r&&t.jsx(U,{text:"update progress",variant:"outline",sx:{fontSize:"12px",padding:"5px 15px",marginTop:"10px"},onClick:s})]}),t.jsx(Ut,{id:p,open:f,anchorEl:o,onClose:g,anchorOrigin:{vertical:"bottom",horizontal:"left"},children:t.jsxs("div",{className:"progress-wrapper",children:[t.jsxs("div",{className:"progress-top",children:[t.jsx("div",{className:"progress-form",children:t.jsxs("div",{children:[t.jsxs("label",{htmlFor:"reading",children:["Currently on",t.jsx("input",{type:"number",name:"reading",id:"reading",style:{height:"25px",width:"60px",margin:"0 10px",padding:"2px 5px"},max:100,min:0,ref:m}),t.jsx("span",{children:"of 100%"})]}),t.jsx(U,{text:"Update",variant:"solid",sx:{padding:"2px 7px",fontSize:"12px",marginLeft:"10px"},onClick:()=>k(e.book._id)})]})}),t.jsx(U,{text:"I'm finished",variant:"text",onClick:()=>a(e.book._id)})]}),t.jsx("div",{className:"progress-footer"})]})}),t.jsx(at,{position:"bottom-left",limit:1})]})};Ft.propTypes={book:J.object,setOpen:J.func,currentUser:J.bool};export{Ft as C,Wt as P};
