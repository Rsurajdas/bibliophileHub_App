import{ad as Ye,ae as Qe,r as l,af as Ve,w as A,j as t,_ as P,x as J,ag as Ze,ah as Je,X as et,a4 as ze,T as De,z as Me,D as Oe,E as U,G as S,H as Ie,y as Ae,ai as tt,aj as rt,Y as je,Z as ke,P as Z,ak as ot,al as nt,c as He,g as st,a as K,a9 as oe,B as H,b as ie,k as at,Q as V}from"./index-335cc679.js";import{T as it,r as lt,g as Ce,M as ct,P as dt,u as Ee,i as ut}from"./Post-d5321762.js";/* empty css             */import{e as pt,k as de,c as ue,T as mt}from"./Typography-8ca9eeea.js";import{d as ft}from"./debounce-517eeb3c.js";const ht=["className","component"];function gt(e={}){const{themeId:r,defaultTheme:o,defaultClassName:i="MuiBox-root",generateClassName:f}=e,x=Ye("div",{shouldForwardProp:p=>p!=="theme"&&p!=="sx"&&p!=="as"})(Qe);return l.forwardRef(function(a,y){const m=Ve(o),n=pt(a),{className:v,component:g="div"}=n,d=A(n,ht);return t.jsx(x,P({as:g,ref:y,className:J(v,f?f(i):i),theme:r&&m[r]||m},d))})}const xt=Ze(),vt=gt({themeId:Je,defaultTheme:xt,defaultClassName:"MuiBox-root",generateClassName:et.generate}),ne=vt,bt=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function le(e){return`scale(${e}, ${e**2})`}const Pt={entering:{opacity:1,transform:le(1)},entered:{opacity:1,transform:"none"}},se=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),Ue=l.forwardRef(function(r,o){const{addEndListener:i,appear:f=!0,children:x,easing:h,in:p,onEnter:a,onEntered:y,onEntering:m,onExit:n,onExited:v,onExiting:g,style:d,timeout:s="auto",TransitionComponent:b=it}=r,k=A(r,bt),X=l.useRef(),z=l.useRef(),E=ze(),R=l.useRef(null),q=De(R,x.ref,o),_=c=>$=>{if(c){const N=R.current;$===void 0?c(N):c(N,$)}},Y=_(m),Q=_((c,$)=>{lt(c);const{duration:N,delay:D,easing:T}=Ce({style:d,timeout:s,easing:h},{mode:"enter"});let B;s==="auto"?(B=E.transitions.getAutoHeightDuration(c.clientHeight),z.current=B):B=N,c.style.transition=[E.transitions.create("opacity",{duration:B,delay:D}),E.transitions.create("transform",{duration:se?B:B*.666,delay:D,easing:T})].join(","),a&&a(c,$)}),ee=_(y),L=_(g),F=_(c=>{const{duration:$,delay:N,easing:D}=Ce({style:d,timeout:s,easing:h},{mode:"exit"});let T;s==="auto"?(T=E.transitions.getAutoHeightDuration(c.clientHeight),z.current=T):T=$,c.style.transition=[E.transitions.create("opacity",{duration:T,delay:N}),E.transitions.create("transform",{duration:se?T:T*.666,delay:se?N:N||T*.333,easing:D})].join(","),c.style.opacity=0,c.style.transform=le(.75),n&&n(c)}),te=_(v),G=c=>{s==="auto"&&(X.current=setTimeout(c,z.current||0)),i&&i(R.current,c)};return l.useEffect(()=>()=>{clearTimeout(X.current)},[]),t.jsx(b,P({appear:f,in:p,nodeRef:R,onEnter:Q,onEntered:ee,onEntering:Y,onExit:F,onExited:te,onExiting:L,addEndListener:G,timeout:s==="auto"?null:s},k,{children:(c,$)=>l.cloneElement(x,P({style:P({opacity:0,transform:le(.75),visibility:c==="exited"&&!p?"hidden":void 0},Pt[c],d,x.props.style),ref:q},$))}))});Ue.muiSupportAuto=!0;const yt=Ue;function jt(e){return Me("MuiLinearProgress",e)}Oe("MuiLinearProgress",["root","colorPrimary","colorSecondary","determinate","indeterminate","buffer","query","dashed","dashedColorPrimary","dashedColorSecondary","bar","barColorPrimary","barColorSecondary","bar1Indeterminate","bar1Determinate","bar1Buffer","bar2Indeterminate","bar2Buffer"]);const kt=["className","color","value","valueBuffer","variant"];let W=e=>e,$e,Ne,Te,we,Re,_e;const ce=4,Ct=de($e||($e=W`
  0% {
    left: -35%;
    right: 100%;
  }

  60% {
    left: 100%;
    right: -90%;
  }

  100% {
    left: 100%;
    right: -90%;
  }
`)),Et=de(Ne||(Ne=W`
  0% {
    left: -200%;
    right: 100%;
  }

  60% {
    left: 107%;
    right: -8%;
  }

  100% {
    left: 107%;
    right: -8%;
  }
`)),$t=de(Te||(Te=W`
  0% {
    opacity: 1;
    background-position: 0 -23px;
  }

  60% {
    opacity: 0;
    background-position: 0 -23px;
  }

  100% {
    opacity: 1;
    background-position: -200px -23px;
  }
`)),Nt=e=>{const{classes:r,variant:o,color:i}=e,f={root:["root",`color${S(i)}`,o],dashed:["dashed",`dashedColor${S(i)}`],bar1:["bar",`barColor${S(i)}`,(o==="indeterminate"||o==="query")&&"bar1Indeterminate",o==="determinate"&&"bar1Determinate",o==="buffer"&&"bar1Buffer"],bar2:["bar",o!=="buffer"&&`barColor${S(i)}`,o==="buffer"&&`color${S(i)}`,(o==="indeterminate"||o==="query")&&"bar2Indeterminate",o==="buffer"&&"bar2Buffer"]};return Ae(f,jt,r)},pe=(e,r)=>r==="inherit"?"currentColor":e.vars?e.vars.palette.LinearProgress[`${r}Bg`]:e.palette.mode==="light"?tt(e.palette[r].main,.62):rt(e.palette[r].main,.5),Tt=U("span",{name:"MuiLinearProgress",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:o}=e;return[r.root,r[`color${S(o.color)}`],r[o.variant]]}})(({ownerState:e,theme:r})=>P({position:"relative",overflow:"hidden",display:"block",height:4,zIndex:0,"@media print":{colorAdjust:"exact"},backgroundColor:pe(r,e.color)},e.color==="inherit"&&e.variant!=="buffer"&&{backgroundColor:"none","&::before":{content:'""',position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:"currentColor",opacity:.3}},e.variant==="buffer"&&{backgroundColor:"transparent"},e.variant==="query"&&{transform:"rotate(180deg)"})),wt=U("span",{name:"MuiLinearProgress",slot:"Dashed",overridesResolver:(e,r)=>{const{ownerState:o}=e;return[r.dashed,r[`dashedColor${S(o.color)}`]]}})(({ownerState:e,theme:r})=>{const o=pe(r,e.color);return P({position:"absolute",marginTop:0,height:"100%",width:"100%"},e.color==="inherit"&&{opacity:.3},{backgroundImage:`radial-gradient(${o} 0%, ${o} 16%, transparent 42%)`,backgroundSize:"10px 10px",backgroundPosition:"0 -23px"})},ue(we||(we=W`
    animation: ${0} 3s infinite linear;
  `),$t)),Rt=U("span",{name:"MuiLinearProgress",slot:"Bar1",overridesResolver:(e,r)=>{const{ownerState:o}=e;return[r.bar,r[`barColor${S(o.color)}`],(o.variant==="indeterminate"||o.variant==="query")&&r.bar1Indeterminate,o.variant==="determinate"&&r.bar1Determinate,o.variant==="buffer"&&r.bar1Buffer]}})(({ownerState:e,theme:r})=>P({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",backgroundColor:e.color==="inherit"?"currentColor":(r.vars||r).palette[e.color].main},e.variant==="determinate"&&{transition:`transform .${ce}s linear`},e.variant==="buffer"&&{zIndex:1,transition:`transform .${ce}s linear`}),({ownerState:e})=>(e.variant==="indeterminate"||e.variant==="query")&&ue(Re||(Re=W`
      width: auto;
      animation: ${0} 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;
    `),Ct)),_t=U("span",{name:"MuiLinearProgress",slot:"Bar2",overridesResolver:(e,r)=>{const{ownerState:o}=e;return[r.bar,r[`barColor${S(o.color)}`],(o.variant==="indeterminate"||o.variant==="query")&&r.bar2Indeterminate,o.variant==="buffer"&&r.bar2Buffer]}})(({ownerState:e,theme:r})=>P({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left"},e.variant!=="buffer"&&{backgroundColor:e.color==="inherit"?"currentColor":(r.vars||r).palette[e.color].main},e.color==="inherit"&&{opacity:.3},e.variant==="buffer"&&{backgroundColor:pe(r,e.color),transition:`transform .${ce}s linear`}),({ownerState:e})=>(e.variant==="indeterminate"||e.variant==="query")&&ue(_e||(_e=W`
      width: auto;
      animation: ${0} 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite;
    `),Et)),Lt=l.forwardRef(function(r,o){const i=Ie({props:r,name:"MuiLinearProgress"}),{className:f,color:x="primary",value:h,valueBuffer:p,variant:a="indeterminate"}=i,y=A(i,kt),m=P({},i,{color:x,variant:a}),n=Nt(m),v=ze(),g={},d={bar1:{},bar2:{}};if((a==="determinate"||a==="buffer")&&h!==void 0){g["aria-valuenow"]=Math.round(h),g["aria-valuemin"]=0,g["aria-valuemax"]=100;let s=h-100;v.direction==="rtl"&&(s=-s),d.bar1.transform=`translateX(${s}%)`}if(a==="buffer"&&p!==void 0){let s=(p||0)-100;v.direction==="rtl"&&(s=-s),d.bar2.transform=`translateX(${s}%)`}return t.jsxs(Tt,P({className:J(n.root,f),ownerState:m,role:"progressbar"},g,{ref:o},y,{children:[a==="buffer"?t.jsx(wt,{className:n.dashed,ownerState:m}):null,t.jsx(Rt,{className:n.bar1,ownerState:m,style:d.bar1}),a==="determinate"?null:t.jsx(_t,{className:n.bar2,ownerState:m,style:d.bar2})]}))}),Bt=Lt;function St(e){return Me("MuiPopover",e)}Oe("MuiPopover",["root","paper"]);const zt=["onEntering"],Dt=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","slots","slotProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps"],Mt=["slotProps"];function Le(e,r){let o=0;return typeof r=="number"?o=r:r==="center"?o=e.height/2:r==="bottom"&&(o=e.height),o}function Be(e,r){let o=0;return typeof r=="number"?o=r:r==="center"?o=e.width/2:r==="right"&&(o=e.width),o}function Se(e){return[e.horizontal,e.vertical].map(r=>typeof r=="number"?`${r}px`:r).join(" ")}function ae(e){return typeof e=="function"?e():e}const Ot=e=>{const{classes:r}=e;return Ae({root:["root"],paper:["paper"]},St,r)},It=U(ct,{name:"MuiPopover",slot:"Root",overridesResolver:(e,r)=>r.root})({}),At=U(dt,{name:"MuiPopover",slot:"Paper",overridesResolver:(e,r)=>r.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),Ht=l.forwardRef(function(r,o){var i,f,x;const h=Ie({props:r,name:"MuiPopover"}),{action:p,anchorEl:a,anchorOrigin:y={vertical:"top",horizontal:"left"},anchorPosition:m,anchorReference:n="anchorEl",children:v,className:g,container:d,elevation:s=8,marginThreshold:b=16,open:k,PaperProps:X={},slots:z,slotProps:E,transformOrigin:R={vertical:"top",horizontal:"left"},TransitionComponent:q=yt,transitionDuration:_="auto",TransitionProps:{onEntering:Y}={}}=h,Q=A(h.TransitionProps,zt),ee=A(h,Dt),L=(i=E==null?void 0:E.paper)!=null?i:X,F=l.useRef(),te=De(F,L.ref),G=P({},h,{anchorOrigin:y,anchorReference:n,elevation:s,marginThreshold:b,externalPaperSlotProps:L,transformOrigin:R,TransitionComponent:q,transitionDuration:_,TransitionProps:Q}),c=Ot(G),$=l.useCallback(()=>{if(n==="anchorPosition")return m;const u=ae(a),C=(u&&u.nodeType===1?u:je(F.current).body).getBoundingClientRect();return{top:C.top+Le(C,y.vertical),left:C.left+Be(C,y.horizontal)}},[a,y.horizontal,y.vertical,m,n]),N=l.useCallback(u=>({vertical:Le(u,R.vertical),horizontal:Be(u,R.horizontal)}),[R.horizontal,R.vertical]),D=l.useCallback(u=>{const j={width:u.offsetWidth,height:u.offsetHeight},C=N(j);if(n==="none")return{top:null,left:null,transformOrigin:Se(C)};const ge=$();let O=ge.top-C.vertical,I=ge.left-C.horizontal;const xe=O+j.height,ve=I+j.width,be=ke(ae(a)),Pe=be.innerHeight-b,ye=be.innerWidth-b;if(O<b){const w=O-b;O-=w,C.vertical+=w}else if(xe>Pe){const w=xe-Pe;O-=w,C.vertical+=w}if(I<b){const w=I-b;I-=w,C.horizontal+=w}else if(ve>ye){const w=ve-ye;I-=w,C.horizontal+=w}return{top:`${Math.round(O)}px`,left:`${Math.round(I)}px`,transformOrigin:Se(C)}},[a,n,$,N,b]),[T,B]=l.useState(k),M=l.useCallback(()=>{const u=F.current;if(!u)return;const j=D(u);j.top!==null&&(u.style.top=j.top),j.left!==null&&(u.style.left=j.left),u.style.transformOrigin=j.transformOrigin,B(!0)},[D]),We=(u,j)=>{Y&&Y(u,j),M()},qe=()=>{B(!1)};l.useEffect(()=>{k&&M()}),l.useImperativeHandle(p,()=>k?{updatePosition:()=>{M()}}:null,[k,M]),l.useEffect(()=>{if(!k)return;const u=ft(()=>{M()}),j=ke(a);return j.addEventListener("resize",u),()=>{u.clear(),j.removeEventListener("resize",u)}},[a,k,M]);let me=_;_==="auto"&&!q.muiSupportAuto&&(me=void 0);const Fe=d||(a?je(ae(a)).body:void 0),re=(f=z==null?void 0:z.root)!=null?f:It,fe=(x=z==null?void 0:z.paper)!=null?x:At,Ge=Ee({elementType:fe,externalSlotProps:P({},L,{style:T?L.style:P({},L.style,{opacity:0})}),additionalProps:{elevation:s,ref:te},ownerState:G,className:J(c.paper,L==null?void 0:L.className)}),he=Ee({elementType:re,externalSlotProps:(E==null?void 0:E.root)||{},externalForwardedProps:ee,additionalProps:{ref:o,slotProps:{backdrop:{invisible:!0}},container:Fe,open:k},ownerState:G,className:J(c.root,g)}),{slotProps:Ke}=he,Xe=A(he,Mt);return t.jsx(re,P({},Xe,!ut(re)&&{slotProps:Ke},{children:t.jsx(q,P({appear:!0,in:k,onEntering:We,onExited:qe,timeout:me},Q,{children:t.jsx(fe,P({},Ge,{children:v}))}))}))}),Ut=Ht,Wt=({post:e})=>{const{user:r}=ot(n=>n.user,nt),[o,i]=l.useState(!1),f=He("token"),[x,h]=l.useState(e.comments),p=st(),a=l.useRef(null),y=async(n,v)=>{try{const s=await(await fetch(`https://boiling-wildwood-46640-30ec30629e36.herokuapp.com/api/v1/posts/${n}/${o?"unlike":"like"}`,{method:"POST",headers:{Authorization:`Bearer ${f}`}})).json();i(s.post.likes.includes(v))}catch(g){console.error(g.message)}},m=(n,v)=>async g=>{g.preventDefault();const d={user:v,text:a.current.value},s=await ie.post(`https://boiling-wildwood-46640-30ec30629e36.herokuapp.com/api/v1/posts/${n}/add-comment`,d,{headers:{Authorization:`Bearer ${f}`}}),{data:b}=s;h(b.post.comments),a.current.value=""};return l.useEffect(()=>{const n=e.likes.some(v=>v._id===p);i(n)},[e.likes,p]),t.jsx(t.Fragment,{children:t.jsxs("div",{className:"post",children:[t.jsx("div",{className:"post-avatar",children:t.jsx(K,{to:`/profile/${e.user._id}`,children:t.jsx(oe,{alt:e.user.name,src:e.user.photo})})}),t.jsxs("div",{className:"post-header",children:[t.jsx("div",{className:"post-by mb-2",children:t.jsx("p",{style:{margin:0},children:e.text})}),t.jsxs("div",{className:"post-details",children:[t.jsx("div",{className:"post-img",children:t.jsx("img",{src:e.book.book_image,alt:e.book.title})}),t.jsxs("div",{className:"post-content",children:[t.jsx("h4",{children:t.jsx(K,{to:`/book/${e.book._id}`,children:e.book.title})}),t.jsxs("div",{className:"post-author",children:["by ",t.jsx(K,{to:"author",children:e.book.author.name})]}),t.jsx("div",{className:"post-description",children:t.jsx("p",{children:e.book.description})})]})]}),t.jsxs("div",{className:"post-activity",children:[t.jsx(H,{type:"button",variant:"text",text:`${o?"Unlike":"Like"}`,onClick:()=>y(e._id,p)})," ","|"," ",t.jsx(H,{type:"button",variant:"text",text:"Comment",onClick:()=>a.current.focus()})]})]}),t.jsxs("div",{className:"post-footer",children:[o&&t.jsx("div",{className:"post-liked",children:"You liked this"}),x&&t.jsx("ul",{className:"post-comments",children:x.map(n=>t.jsx("li",{children:t.jsxs("div",{className:"comment-body",children:[t.jsx(oe,{alt:n.user.name,src:`${n.user.photo}`}),t.jsxs("div",{className:"comment-user",children:[t.jsx("h6",{className:"user-name mb-1",children:t.jsx(K,{to:`/profile/${n.user._id}`,children:n.user.name})}),t.jsx("div",{className:"user-comment",children:n.text})]})]})},n._id))}),t.jsxs("div",{className:"post-comment",children:[t.jsx(oe,{alt:r.name,src:r.photo}),t.jsx("form",{method:"post",onSubmit:m(e._id,p),children:t.jsxs("div",{className:"form-group d-flex",style:{gap:"2%"},children:[t.jsx("textarea",{name:"comment",id:"comment",style:{height:"40px"},ref:a}),t.jsx(H,{variant:"solid",text:"comment",sx:{padding:"3px 10px"},type:"submit"})]})})]})]})]})})};Wt.propTypes={post:Z.object};const qt=({book:e,currentUser:r})=>{const[o,i]=l.useState(null),[f,x]=l.useState(e.readingProgress),h=l.useRef(null),p=He("token"),a=d=>{i(d.currentTarget)},y=()=>{i(null)},m=!!o,n=m?"simple-popover":void 0,v=async d=>{try{const s={readingProgress:Number(h.current.value)},b=await ie.patch(`https://boiling-wildwood-46640-30ec30629e36.herokuapp.com/api/v1/shelf/update-progress/${d}`,s,{headers:{Authorization:`Bearer ${p}`}}),{data:k}=b;x(h.current.value),V.success(k.message)}catch(s){V.error(s.message)}},g=async d=>{try{const s={readingProgress:100},b=await ie.patch(`https://boiling-wildwood-46640-30ec30629e36.herokuapp.com/api/v1/shelf/update-progress/${d}`,s,{headers:{Authorization:`Bearer ${p}`}}),{data:k}=b;x(100),i(null),V.success(k.message)}catch(s){V.error(s.message)}};return t.jsxs("div",{className:"reading mb-3",children:[t.jsx("div",{className:"reading-img",children:t.jsx("img",{src:e.book.book_image,alt:e.book.title})}),t.jsxs("div",{className:"reading-content",children:[t.jsx("h6",{children:t.jsx(K,{to:`/book/${e.book._id}`,style:{color:"#2a2a2a"},children:e.book.title})}),t.jsx("div",{className:"mb-2",children:e.book.author.name}),f>0&&t.jsxs(ne,{sx:{display:"flex",alignItems:"center"},children:[t.jsx(ne,{sx:{width:"100%",mr:1},children:t.jsx(Bt,{variant:"determinate",value:Number(f),color:"success"})}),t.jsx(ne,{sx:{minWidth:35},children:t.jsx(mt,{variant:"body2",color:"text.secondary",children:`${Math.round(f)}/100%`})})]}),r&&t.jsx(H,{text:"update progress",variant:"outline",sx:{fontSize:"12px",padding:"5px 15px",marginTop:"10px"},onClick:a})]}),t.jsx(Ut,{id:n,open:m,anchorEl:o,onClose:y,anchorOrigin:{vertical:"bottom",horizontal:"left"},children:t.jsxs("div",{className:"progress-wrapper",children:[t.jsxs("div",{className:"progress-top",children:[t.jsx("div",{className:"progress-form",children:t.jsxs("div",{children:[t.jsxs("label",{htmlFor:"reading",children:["Currently on",t.jsx("input",{type:"number",name:"reading",id:"reading",style:{height:"25px",width:"60px",margin:"0 10px",padding:"2px 5px"},max:100,min:0,ref:h}),t.jsx("span",{children:"of 100%"})]}),t.jsx(H,{text:"Update",variant:"solid",sx:{padding:"2px 7px",fontSize:"12px",marginLeft:"10px"},onClick:()=>v(e.book._id)})]})}),t.jsx(H,{text:"I'm finished",variant:"text",onClick:()=>g(e.book._id)})]}),t.jsx("div",{className:"progress-footer"})]})}),t.jsx(at,{position:"bottom-left",limit:1})]})};qt.propTypes={book:Z.object,setOpen:Z.func,currentUser:Z.bool};export{qt as C,Wt as P};
